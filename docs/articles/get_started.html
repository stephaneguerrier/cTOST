<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>`cTOST` Vignette • cTOST</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="`cTOST` Vignette">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cTOST</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/get_started.html">`cTOST` Vignette</a></li>
    <li><a class="dropdown-item" href="../articles/reproducibility.html">Results Reproducibility</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stephaneguerrier/cTOST/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>`cTOST` Vignette</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stephaneguerrier/cTOST/blob/HEAD/vignettes/get_started.Rmd" class="external-link"><code>vignettes/get_started.Rmd</code></a></small>
      <div class="d-none name"><code>get_started.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Equivalence testing has first appeared in the field of
pharmacokinetics <span class="citation">Metzler (1974)</span>, and find
their most common application in the context of generic drug
manufacturing <span class="citation">Senn (2021)</span> where the aim is
to determine whether a parameter like the mean variation of treatment
response between a reference and a generic drug falls within a
predetermined equivalence range that we denote
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mi>c</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(-c,c)</annotation></semantics></math>,
indicating that drugs are equivalent. Deviations within this region
would be considered insignificant as they are too small to reflect the
dissimilarity of the therapeutic effects between the compared
treatments. In contrast to standard hypothesis testing for equality of
means, where the null hypothesis assumes that both means are equal, and
the alternative assumes they are not, equivalence testing reverses the
roles of the hypothesis formulations and considers a region rather than
a point. Specifically, it defines the alternative as the equivalence
region within which the parameter of interest must lie for the
treatments to be considered equivalent, and the null hypothesis as the
opposite. This paradigm puts the burden of proof on equivalence, rather
than non-equality, and emphasizes the importance of assessing the
similarity of treatments in addition to their differences.</p>
</div>
<div class="section level2">
<h2 id="mathematical-setup">Mathematical setup<a class="anchor" aria-label="anchor" href="#mathematical-setup"></a>
</h2>
<p>More formally, the hypotheses of interest are defined as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mspace width="0.278em"></mspace><mi>θ</mi><mo>∉</mo><msub><mi>Θ</mi><mn>1</mn></msub><mspace width="1.0em"></mspace><mi>v</mi><mi>s</mi><mi>.</mi><mspace width="1.0em"></mspace><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><mspace width="0.278em"></mspace><mi>θ</mi><mo>∈</mo><msub><mi>Θ</mi><mn>1</mn></msub><mo>:=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mi>L</mi></msub><mo>,</mo><mspace width="0.167em"></mspace><msub><mi>θ</mi><mi>U</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation*}
    H_0: \; \theta \not\in \Theta_1 \quad vs. \quad H_1: \; \theta \in \Theta_1 := (\theta_L, \, \theta_U),
\end{equation*}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Θ</mi><mn>1</mn></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mi>L</mi></msub><mo>,</mo><msub><mi>θ</mi><mi>U</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Theta_1=(\theta_L,\theta_U)</annotation></semantics></math>
denotes the range of equivalence whose limits are known constants, and
are usually symmetrical so we define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>:=</mo><msub><mi>θ</mi><mi>U</mi></msub><mo>=</mo><mi>−</mi><msub><mi>θ</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">c:=\theta_U=-\theta_L</annotation></semantics></math>.</p>
<p>Existing approaches, such as the state-of-the-art Two One-Sided Tests
(TOST) <span class="citation">Schuirmann (1987)</span>, have
demonstrated conservativeness and decreased power, particularly for
highly variable responses. This can be demonstrated by computing the
power function which would be evaluated at different points of the
parameter space. In particular, evaluating it at the equivalence bounds
yields the size and shows that it is strictly bounded by the
significance level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.
To see this more clearly, consider a canonical form for the average
equivalence problem in the univariate framework, which consists of two
independent random variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>θ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\widehat{\theta}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>ν</mi></msub><annotation encoding="application/x-tex">\widehat{\sigma}_{\nu}</annotation></semantics></math>
with distributions</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>,</mo><msubsup><mi>σ</mi><mi>ν</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mtext mathvariant="normal">and</mtext><mspace width="1.0em"></mspace><mi>ν</mi><mfrac><msubsup><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>ν</mi><mn>2</mn></msubsup><msubsup><mi>σ</mi><mi>ν</mi><mn>2</mn></msubsup></mfrac><mo>∼</mo><msubsup><mi>χ</mi><mi>ν</mi><mn>2</mn></msubsup><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation*}
    \widehat{\theta} \sim N\left(\theta, \sigma_{\nu}^2\right), \quad \text{and} \quad \nu\frac{\widehat{\sigma}_{\nu}^2}{\sigma_{\nu}^2} \sim \chi^2_{\nu},
\end{equation*}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
is the parameter of interest,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>ν</mi></msub><annotation encoding="application/x-tex">\sigma_{\nu}</annotation></semantics></math>
is the standard error and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
are the degrees of freedom.</p>
<p>The TOST is based on two test statistics</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>L</mi></msub><mo>:=</mo><mfrac><mrow><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo>+</mo><mi>c</mi></mrow><msub><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>ν</mi></msub></mfrac><mo>∼</mo><msub><mi>t</mi><mi>ν</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>θ</mi><mo>+</mo><mi>c</mi></mrow><msub><mi>σ</mi><mi>ν</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mtext mathvariant="normal">and</mtext><mspace width="1.0em"></mspace><msub><mi>T</mi><mi>U</mi></msub><mo>:=</mo><mfrac><mrow><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo>−</mo><mi>c</mi></mrow><msub><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>ν</mi></msub></mfrac><mo>∼</mo><msub><mi>t</mi><mi>ν</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>θ</mi><mo>−</mo><mi>c</mi></mrow><msub><mi>σ</mi><mi>ν</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation*}
T_L := \frac{\widehat{\theta}+c}{\widehat{\sigma}_{\nu}}\sim t_\nu\left(\frac{\theta+c}{\sigma_\nu}\right), \quad\text{and}\quad T_U := \frac{\widehat{\theta}-c}{\widehat{\sigma}_{\nu}}\sim t_\nu\left(\frac{\theta-c}{\sigma_\nu}\right).
\end{equation*}</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mtext mathvariant="normal">H</mtext><mn>0</mn></msub><annotation encoding="application/x-tex">\text{H}_{0}</annotation></semantics></math>
is rejected in favor of equivalence if both tests simultaneously reject
their marginal null hypotheses, i.e.,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>L</mi></msub><mo>≥</mo><msub><mi>t</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mo>,</mo><mi>ν</mi></mrow></msub><mo>,</mo><mspace width="1.0em"></mspace><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and</mtext></mrow><mspace width="1.0em"></mspace><msub><mi>T</mi><mi>U</mi></msub><mo>≤</mo><mi>−</mi><msub><mi>t</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mo>,</mo><mi>ν</mi></mrow></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation*}
     T_L \geq t_{1-\alpha,\nu}, \quad \text{ and} \quad T_U \leq -t_{1-\alpha,\nu}.
\end{equation*}</annotation></semantics></math></p>
<p>By rearranging the terms, we can define a rejection region for the
TOST:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub><mo>:=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo>∈</mo><mi>ℝ</mi><mo>,</mo><mspace width="0.167em"></mspace><msub><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>ν</mi></msub><mo>∈</mo><msub><mi>ℝ</mi><mo>+</mo></msub><mspace width="0.167em"></mspace><mo minsize="1.8" maxsize="1.8" stretchy="false" form="postfix">|</mo><mspace width="0.167em"></mspace><mo stretchy="false" form="postfix">|</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="false" form="postfix">|</mo><mo>≤</mo><mi>c</mi><mo>−</mo><msub><mi>t</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mo>,</mo><mi>ν</mi></mrow></msub><msub><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>ν</mi></msub><mo stretchy="true" form="postfix">}</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation*}
    C_1 := \left\{\widehat{\theta} \in \mathbb{R},\, \widehat{\sigma}_{\nu} \in \mathbb{R}_+ \,\Big\vert \,  \vert\widehat{\theta}\vert  \leq  c - t_{1-\alpha,\nu} \hat{\sigma}_\nu  \right\}.
\end{equation*}</annotation></semantics></math></p>
<p>Given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>ν</mi></msub><annotation encoding="application/x-tex">\sigma_{\nu}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>,
the power function of the TOST corresponds to the probability of
rejecting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>,
i.e., the integral of the joint density of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo>,</mo><msub><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>ν</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\hat{\theta},\hat{\sigma}_\nu)</annotation></semantics></math>
over the rejection area
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>1</mn></msub><annotation encoding="application/x-tex">C_1</annotation></semantics></math>
(see also <span class="citation">Phillips (1990)</span>), that is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>θ</mi><mo>,</mo><msub><mi>σ</mi><mi>ν</mi></msub><mo>,</mo><mi>ν</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo></mtd><mtd columnalign="left" style="text-align: left"><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>L</mi></msub><mo>≥</mo><msub><mi>t</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mo>,</mo><mi>ν</mi></mrow></msub><mspace width="0.278em"></mspace><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and</mtext></mrow><mspace width="0.278em"></mspace><msub><mi>T</mi><mi>U</mi></msub><mo>≤</mo><mi>−</mi><msub><mi>t</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mo>,</mo><mi>ν</mi></mrow></msub><mspace width="0.167em"></mspace><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">|</mo><mspace width="0.278em"></mspace><mi>α</mi><mo>,</mo><mi>θ</mi><mo>,</mo><msub><mi>σ</mi><mi>ν</mi></msub><mo>,</mo><mi>ν</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mo>=</mo></mtd><mtd columnalign="left" style="text-align: left"><msubsup><mo>∫</mo><mn>0</mn><mi>∞</mi></msubsup><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>ν</mi></msub><msub><mi>t</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mo>,</mo><mi>ν</mi></mrow></msub><mo>&lt;</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">{</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>c</mi><mo>+</mo><msub><mi>t</mi><mrow><mi>α</mi><mo>,</mo><mi>ν</mi></mrow></msub><msub><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>ν</mi></msub><mo>−</mo><mi>θ</mi></mrow><msub><mi>σ</mi><mi>ν</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mfrac><mrow><mi>c</mi><mo>+</mo><msub><mi>t</mi><mrow><mi>α</mi><mo>,</mo><mi>ν</mi></mrow></msub><msub><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>ν</mi></msub><mo>+</mo><mi>θ</mi></mrow><msub><mi>σ</mi><mi>ν</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mphantom><mo>=</mo></mphantom></mtd><mtd columnalign="left" style="text-align: left"><mi>×</mi><msub><mi>f</mi><mi>W</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>ν</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>σ</mi><mi>ν</mi></msub><mo>,</mo><mi>ν</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><msub><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>ν</mi></msub><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation*}
    \begin{aligned}
        p(\alpha, \theta, \sigma_{\nu}, \nu, c) :=&amp; \Pr\left(T_L \geq t_{1-\alpha,\nu}\; \text{{ and}} \;  T_U \leq -t_{1-\alpha,\nu}\,  \big|\;  \alpha, \theta, \sigma_{\nu}, \nu, c \right)\\
        =&amp;\int_0^\infty I(\widehat\sigma_\nu t_{1-\alpha,\nu} &lt; c)\left\{\Phi\left(\frac{c+t_{\alpha,\nu} \widehat\sigma_\nu-\theta}{\sigma_\nu}\right)
    -\Phi\left(-\frac{c+ t_{\alpha,\nu} \widehat\sigma_\nu+\theta}{\sigma_\nu}
    \right) \right\} \\
        \phantom{=}&amp;\times f_W ( \widehat\sigma_\nu \lvert \sigma_\nu,\nu)d\widehat\sigma_\nu.
    \end{aligned}
\end{equation*}</annotation></semantics></math> Noting that the vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>L</mi></msub><mo>,</mo><msub><mi>T</mi><mi>U</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(T_L,T_U)</annotation></semantics></math>
has a bivariate non-central
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-distribution
with non-centrality parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>θ</mi><mo>−</mo><mi>c</mi></mrow><msub><mi>σ</mi><mi>ν</mi></msub></mfrac><annotation encoding="application/x-tex">\frac{\theta-c}{\sigma_\nu}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>θ</mi><mo>+</mo><mi>c</mi></mrow><msub><mi>σ</mi><mi>ν</mi></msub></mfrac><annotation encoding="application/x-tex">\frac{\theta+c}{\sigma_\nu}</annotation></semantics></math>
respectively, we can express the power function in terms of Owen’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math>-function
<span class="citation">Owen (1965)</span>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>θ</mi><mo>,</mo><msub><mi>σ</mi><mi>ν</mi></msub><mo>,</mo><mi>ν</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>Q</mi><mi>ν</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>t</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mo>,</mo><mi>ν</mi></mrow></msub><mo>,</mo><mspace width="0.167em"></mspace><mfrac><mrow><mi>θ</mi><mo>−</mo><mi>c</mi></mrow><msub><mi>σ</mi><mi>ν</mi></msub></mfrac><mo>,</mo><mspace width="0.167em"></mspace><mfrac><mrow><mi>c</mi><msqrt><mi>ν</mi></msqrt></mrow><mrow><msub><mi>σ</mi><mi>ν</mi></msub><msub><mi>t</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mo>,</mo><mi>ν</mi></mrow></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>Q</mi><mi>ν</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mo>,</mo><mi>ν</mi></mrow></msub><mo>,</mo><mspace width="0.167em"></mspace><mfrac><mrow><mi>θ</mi><mo>+</mo><mi>c</mi></mrow><msub><mi>σ</mi><mi>ν</mi></msub></mfrac><mo>,</mo><mspace width="0.167em"></mspace><mfrac><mrow><mi>c</mi><msqrt><mi>ν</mi></msqrt></mrow><mrow><msub><mi>σ</mi><mi>ν</mi></msub><msub><mi>t</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mo>,</mo><mi>ν</mi></mrow></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation*}
    \begin{aligned}
        p(\alpha, \theta, \sigma_{\nu}, \nu, c) :=&amp; Q_{\nu}\left(-t_{1-\alpha,\nu},\, \frac{\theta - c}{\sigma_{\nu}},\, \frac{c \sqrt{\nu}}{\sigma_{\nu} t_{1-\alpha,\nu}} \right) - Q_{\nu}\left(t_{1-\alpha,\nu},\, \frac{\theta + c}{\sigma_{\nu}},\, \frac{c \sqrt{\nu}}{\sigma_{\nu} t_{1-\alpha,\nu}} \right).
    \end{aligned}
\end{equation*}</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="conservativeness-of-the-tost">Conservativeness of the TOST<a class="anchor" aria-label="anchor" href="#conservativeness-of-the-tost"></a>
</h2>
<p>This formulation allows to demonstrate that, for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mi>ν</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sigma_{\nu}&gt;0</annotation></semantics></math>,
the TOST is not
size-<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
in finite samples as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>ω</mi><mi>ν</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>c</mi><mo>,</mo><msub><mi>σ</mi><mi>ν</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>:=</mo><munder><mo>sup</mo><mrow><mi>θ</mi><mspace width="0.167em"></mspace><mo>∈</mo><mspace width="0.167em"></mspace><msub><mi>Θ</mi><mn>0</mn></msub></mrow></munder><mspace width="0.278em"></mspace><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>θ</mi><mo>,</mo><msub><mi>σ</mi><mi>ν</mi></msub><mo>,</mo><mi>ν</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>&lt;</mo><msub><mi>Q</mi><mi>ν</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><msub><mi>t</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mo>,</mo><mi>ν</mi></mrow></msub><mo>,</mo><mspace width="0.167em"></mspace><mn>0</mn><mo>,</mo><mspace width="0.167em"></mspace><mfrac><mrow><mi>c</mi><msqrt><mi>ν</mi></msqrt></mrow><mrow><msub><mi>σ</mi><mi>ν</mi></msub><msub><mi>t</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mo>,</mo><mi>ν</mi></mrow></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>ν</mi></msub><mo>≤</mo><mi>−</mi><msub><mi>t</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mo>,</mo><mi>ν</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>α</mi><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation*}
    \begin{aligned}
    \omega_\nu(\alpha, c, \sigma_{\nu}) &amp;:= \sup_{\theta \, \in \, \Theta_0}\; p(\alpha, \theta, \sigma_{\nu}, \nu, c) \\
    &amp;&lt; Q_{\nu}\left(-t_{1-\alpha,\nu},\, 0,\, \frac{c \sqrt{\nu}}{\sigma_{\nu} t_{1-\alpha,\nu}} \right) &lt; \Pr\left(T_{\nu} \leq -t_{1-\alpha,\nu}\right) = \alpha,
    \end{aligned}
\end{equation*}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Θ</mi><mn>0</mn></msub><mo>:=</mo><mi>ℝ</mi><mo>\</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mi>c</mi><mo>,</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Theta_0:=\mathbb{R}\setminus(-c,c)</annotation></semantics></math>
corresponds to parameter space under the null.</p>
</div>
<div class="section level2">
<h2 id="finite-sample-corrections-to-the-tost">Finite sample corrections to the TOST<a class="anchor" aria-label="anchor" href="#finite-sample-corrections-to-the-tost"></a>
</h2>
<p>As
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ω</mi><mi>ν</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>,</mo><msub><mi>σ</mi><mi>ν</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\omega_\nu(\gamma, \delta, \sigma_{\nu})</annotation></semantics></math>
is continuously differentiable and strictly increasing in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>,
solving the following matching paradigms represents a finite sample
correction to the TOST and would ensure
size-<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
tests:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>α</mi><mo>*</mo></msup><mo>:=</mo><msub><mtext mathvariant="normal">argzero</mtext><mrow><mi>γ</mi><mo>∈</mo><mo stretchy="false" form="prefix">[</mo><mi>α</mi><mo>,</mo><mn>0.5</mn><mo stretchy="false" form="postfix">)</mo></mrow></msub><mspace width="0.278em"></mspace><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><msub><mi>ω</mi><mi>ν</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>γ</mi><mo>,</mo><mi>c</mi><mo>,</mo><msub><mi>σ</mi><mi>ν</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>α</mi><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">\alpha^*:=\text{argzero}_{\gamma \in [\alpha, 0.5)} \;\big[ \omega_\nu(\gamma, c, \sigma_{\nu}) - \alpha\big],</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>c</mi><mo>*</mo></msup><mo>:=</mo><msub><mtext mathvariant="normal">argzero</mtext><mrow><mi>δ</mi><mo>∈</mo><mo stretchy="false" form="prefix">[</mo><mn>1</mn><mo>,</mo><mi>∞</mi><mo stretchy="false" form="postfix">)</mo></mrow></msub><mspace width="0.278em"></mspace><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><msub><mi>ω</mi><mi>ν</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>δ</mi><mo>,</mo><msub><mi>σ</mi><mi>ν</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>α</mi><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">c^*:=\text{argzero}_{\delta \in [1, \infty)} \;\big[ \omega_\nu(\alpha, \delta, \sigma_{\nu}) - \alpha\big].</annotation></semantics></math></p>
<p>The conditions under which the solutions are singletons and provide a
uniformly more powerful inference are studied in length in <span class="citation">Boulaguiem et al. (2023)</span> and compared to
existing methods.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-boulaguiem2023finite" class="csl-entry">
Boulaguiem, Y., J. Quartier, M. Lapteva, Y. N. Kalia, M.-P.
Victoria-Feser, S. Guerrier, and D.-L. Couturier. 2023. <span>“Finite
Sample Adjustments for Average Equivalence Testing.”</span>
<em>Statistics in Medicine</em>, 2023–03.
</div>
<div id="ref-Metzler74" class="csl-entry">
Metzler, C. M. 1974. <span>“Bioavailability – a Problem in
Equivalence.”</span> <em>Journal of Pharmaceutical Sciences</em> 30:
309–17.
</div>
<div id="ref-Owen65" class="csl-entry">
Owen, D. B. 1965. <span>“<span class="nocase">A special case of a
bivariate non-central
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-distribution</span>.”</span>
<em>Biometrika</em> 52: 437–46.
</div>
<div id="ref-Phil90" class="csl-entry">
Phillips, K. 1990. <span>“Power of the Two One-Sided Tests Procedure in
Bioequivalence.”</span> <em>Journal of Pharmacokinetics and
Biopharmaceutics</em> 18: 137–44.
</div>
<div id="ref-schuirmann1987comparison" class="csl-entry">
Schuirmann, D. J. 1987. <span>“A Comparison of the Two One-Sided Tests
Procedure and the Power Approach for Assessing the Equivalence of
Average Bioavailability.”</span> <em>Journal of Pharmacokinetics and
Biopharmaceutics</em> 15 (6): 657–80.
</div>
<div id="ref-SennBook21" class="csl-entry">
Senn, S. 2021. <em>Statistical Issues in Drug Development, 3rd
Edition</em>. Wiley.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stéphane Guerrier, Younes Boulaguiem, Dominique-Laurent Couturier, Luca Insolia, Jun Wu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
