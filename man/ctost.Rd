% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/average_equivalence.R
\name{ctost}
\alias{ctost}
\title{Finite Sample Adjustment for Average (Bio)Equivalence Assessment}
\usage{
ctost(
  theta,
  sigma,
  nu,
  delta,
  alpha = 0.05,
  method,
  B = 10^4,
  seed = 101010,
  correction = NULL,
  ...
)
}
\arguments{
\item{theta}{A \code{numeric} value or vector representing the estimated difference(s) (e.g., between a generic and reference product).}

\item{sigma}{A \code{numeric} value (univariate) or \code{matrix} (multivariate) corresponding to the estimated variance of \code{theta}.}

\item{nu}{A \code{numeric} value specifying the degrees of freedom. In the multivariate case, it is assumed to be the same across all dimensions.}

\item{delta}{A \code{numeric} value or vector defining the (bio)equivalence margin(s). The procedure assumes symmetry, i.e., the (bio)equivalence region is \eqn{(-\delta, \delta)}. In the multivariate case, it is assumed to be the same across all dimensions.}

\item{alpha}{A \code{numeric} value specifying the significance level, which must be between 0 and 0.5 (default: \code{alpha = 0.05}).}

\item{method}{A \code{character} string specifying the finite sample adjustment method. Available methods are: \code{"unadjusted"} (standard unadjusted TOST), \code{"alpha"} (alpha-TOST), \code{"delta"} (delta-TOST, not implemented for multivariate settings), and \code{"optimal"} (cTOST, default). See Details.}

\item{B}{A \code{numeric} value specifying the number of Monte Carlo replications, required for some methods (default: \code{B = 10^4}).}

\item{seed}{A \code{numeric} value specifying a seed for reproducibility (default: \code{seed = 101010}).}

\item{correction}{A \code{character} string specifying the correction method. Available options are: \code{"none"} (no correction), \code{"offline"} (offline adjustment), and \code{"bootstrap"} (bootstrap adjustment). In univariate settings, the default is \code{"offline"}; in multivariate settings, the default is \code{"bootstrap"} if \code{nu} < 100, otherwise \code{"none"}.}

\item{...}{Additional parameters.}
}
\value{
An object of class \code{tost} with the following components:
\itemize{
  \item \code{decision}: Logical; indicates whether (bio)equivalence is accepted.
  \item \code{ci}: Confidence region at the \eqn{1 - 2\alpha} level.
  \item \code{theta}: The estimated difference(s) used in the test.
  \item \code{sigma}: The estimated variance of \code{theta}; a \code{numeric} value (univariate) or \code{matrix} (multivariate).
  \item \code{nu}: The degrees of freedom used in the test.
  \item \code{alpha}: The significance level used in the test.
  \item \code{corrected_alpha}: The significance level after adjustment (if \code{method = "alpha"}).
  \item \code{corrected_delta}: The (bio)equivalence limits after adjustment (if \code{method = "delta"}).
  \item \code{delta}: The (bio)equivalence limits used in the test.
  \item \code{method}: The adjustment method used (optimal, alpha-TOST, or delta-TOST).
  \item \code{setting}: The setting used ("univariate" or "multivariate").
}
}
\description{
Computes finite sample corrected versions of the standard (univariate or multivariate) TOST, as developed in Boulaguiem et al. (2024, https://doi.org/10.1002/sim.9993), Boulaguiem et al. (2024, https://doi.org/10.1002/sim.10258), and Insolia et al. (2025).
}
\details{
In univariate settings, three adjustment methods are available: optimal (cTOST, \code{method = "optimal"}) as proposed in Insolia et al. (2025), alpha-TOST (\code{method = "alpha"}), and delta-TOST (\code{method = "delta"}), both proposed in Boulaguiem et al. (2024, https://doi.org/10.1002/sim.9993, https://doi.org/10.1002/sim.10258). For multivariate settings, only cTOST and alpha-TOST are implemented.

The cTOST, alpha-TOST, and delta-TOST methods apply different finite sample adjustments. Alpha-TOST corrects the significance level, while delta-TOST adjusts the equivalence limits. The cTOST method is based on a more complex approach, and in small samples (typically less than 30), additional corrections may be beneficial. The \code{correction} argument further adjusts the test level to prevent liberal inference; see Insolia et al. (2025) for details.

Generally, cTOST outperforms other methods, with alpha-TOST performing better than delta-TOST. For this reason, delta-TOST is not implemented for multivariate settings and is not recommended.
}
\examples{
data(skin)
theta_hat = diff(apply(skin, 2, mean))
nu = nrow(skin) - 1
sig_hat = var(apply(skin, 1, diff)) / nu

# alpha-TOST
atost = ctost(theta = theta_hat, sigma = sig_hat, nu = nu,
              alpha = 0.05, delta = log(1.25), method = "alpha")
atost
compare_to_tost(atost)

# delta-TOST
dtost = ctost(theta = theta_hat, sigma = sig_hat, nu = nu,
              alpha = 0.05, delta = log(1.25), method = "delta")
dtost
compare_to_tost(dtost)
}
